{% extends 'base.html' %}
{% block content %}
<h2>Chat with AI Tutor</h2>

<form method="POST" onsubmit="startProgress()">
  <input name="user_input" class="form-control mb-3" placeholder="Ask something..." value="{{ request.form.user_input }}">
  <button class="btn btn-success">Send</button>
</form>

<!-- Progress Bar -->
<div id="progress-container" style="margin-top: 20px; display: none;">
  <div style="height: 20px; background: #eee; border-radius: 4px; overflow: hidden;">
    <div id="progress-bar" style="height: 100%; width: 0%; background: #28a745; text-align: center; color: white;"></div>
  </div>
  <p id="progress-label" style="margin-top: 5px;"></p>
</div>

{% if response %}
  <h4 class="mt-4">Response:</h4>
  <pre>{{ response }}</pre>
{% endif %}

<script>
function startProgress() {
  const container = document.getElementById('progress-container');
  const bar = document.getElementById('progress-bar');
  const label = document.getElementById('progress-label');

  container.style.display = 'block';
  let progress = 0;

  const interval = setInterval(() => {
    if (progress >= 100) {
      clearInterval(interval);
      label.innerText = "Done!";
    } else {
      progress += Math.floor(Math.random() * 10) + 7;
      progress = Math.min(progress, 100);
      bar.style.width = progress + '%';
      label.innerText = progress + '% complete';
    }
  }, 300);
}
</script>
{% endblock %}

